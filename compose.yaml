services:
  backend-db:
    image: postgres:18
    container_name: hotelier-backend-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${POSTGRES_DB}
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - backend_db_data:/var/lib/postgresql/data
    ports:
      - "${POSTGRES_PORT}:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER} -d ${POSTGRES_DB}"]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  parking-service-db:
    image: postgres:18
    container_name: hotelier-parking-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${PARKING_POSTGRES_DB}
      POSTGRES_USER: ${PARKING_POSTGRES_USER}
      POSTGRES_PASSWORD: ${PARKING_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - parking_service_db_data:/var/lib/postgresql/data
    ports:
      - "${PARKING_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${PARKING_POSTGRES_USER} -d ${PARKING_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  auth-service-db:
    image: postgres:18
    container_name: hotelier-auth-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${AUTH_POSTGRES_DB}
      POSTGRES_USER: ${AUTH_POSTGRES_USER}
      POSTGRES_PASSWORD: ${AUTH_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - auth_service_db_data:/var/lib/postgresql/data
    ports:
      - "${AUTH_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${AUTH_POSTGRES_USER} -d ${AUTH_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  config-service-db:
    image: postgres:18
    container_name: hotelier-config-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${CONFIG_POSTGRES_DB}
      POSTGRES_USER: ${CONFIG_POSTGRES_USER}
      POSTGRES_PASSWORD: ${CONFIG_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - config_service_db_data:/var/lib/postgresql/data
    ports:
      - "${CONFIG_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${CONFIG_POSTGRES_USER} -d ${CONFIG_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  notifications-service-db:
    image: postgres:18
    container_name: hotelier-notifications-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${NOTIFICATIONS_POSTGRES_DB}
      POSTGRES_USER: ${NOTIFICATIONS_POSTGRES_USER}
      POSTGRES_PASSWORD: ${NOTIFICATIONS_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - notifications_service_db_data:/var/lib/postgresql/data
    ports:
      - "${NOTIFICATIONS_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${NOTIFICATIONS_POSTGRES_USER} -d ${NOTIFICATIONS_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  inventory-service-db:
    image: postgres:18
    container_name: hotelier-inventory-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${INVENTORY_POSTGRES_DB}
      POSTGRES_USER: ${INVENTORY_POSTGRES_USER}
      POSTGRES_PASSWORD: ${INVENTORY_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - inventory_service_db_data:/var/lib/postgresql/data
    ports:
      - "${INVENTORY_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${INVENTORY_POSTGRES_USER} -d ${INVENTORY_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  staff-service-db:
    image: postgres:18
    container_name: hotelier-staff-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${STAFF_POSTGRES_DB}
      POSTGRES_USER: ${STAFF_POSTGRES_USER}
      POSTGRES_PASSWORD: ${STAFF_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - staff_service_db_data:/var/lib/postgresql/data
    ports:
      - "${STAFF_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${STAFF_POSTGRES_USER} -d ${STAFF_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  guest-requests-service-db:
    image: postgres:18
    container_name: hotelier-guest-requests-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${GUEST_REQUESTS_POSTGRES_DB}
      POSTGRES_USER: ${GUEST_REQUESTS_POSTGRES_USER}
      POSTGRES_PASSWORD: ${GUEST_REQUESTS_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - guest_requests_service_db_data:/var/lib/postgresql/data
    ports:
      - "${GUEST_REQUESTS_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${GUEST_REQUESTS_POSTGRES_USER} -d ${GUEST_REQUESTS_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  booking-service-db:
    image: postgres:18
    container_name: hotelier-booking-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${BOOKING_POSTGRES_DB}
      POSTGRES_USER: ${BOOKING_POSTGRES_USER}
      POSTGRES_PASSWORD: ${BOOKING_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - booking_service_db_data:/var/lib/postgresql/data
    ports:
      - "${BOOKING_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${BOOKING_POSTGRES_USER} -d ${BOOKING_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  operations-service-db:
    image: postgres:18
    container_name: hotelier-operations-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${OPERATIONS_POSTGRES_DB}
      POSTGRES_USER: ${OPERATIONS_POSTGRES_USER}
      POSTGRES_PASSWORD: ${OPERATIONS_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - operations_service_db_data:/var/lib/postgresql/data
    ports:
      - "${OPERATIONS_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${OPERATIONS_POSTGRES_USER} -d ${OPERATIONS_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  events-service-db:
    image: postgres:18
    container_name: hotelier-events-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${EVENTS_POSTGRES_DB}
      POSTGRES_USER: ${EVENTS_POSTGRES_USER}
      POSTGRES_PASSWORD: ${EVENTS_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - events_service_db_data:/var/lib/postgresql/data
    ports:
      - "${EVENTS_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${EVENTS_POSTGRES_USER} -d ${EVENTS_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  restaurant-service-db:
    image: postgres:18
    container_name: hotelier-restaurant-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${RESTAURANT_POSTGRES_DB}
      POSTGRES_USER: ${RESTAURANT_POSTGRES_USER}
      POSTGRES_PASSWORD: ${RESTAURANT_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - restaurant_service_db_data:/var/lib/postgresql/data
    ports:
      - "${RESTAURANT_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${RESTAURANT_POSTGRES_USER} -d ${RESTAURANT_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  recreational-service-db:
    image: postgres:18
    container_name: hotelier-recreational-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${RECREATIONAL_POSTGRES_DB}
      POSTGRES_USER: ${RECREATIONAL_POSTGRES_USER}
      POSTGRES_PASSWORD: ${RECREATIONAL_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - recreational_service_db_data:/var/lib/postgresql/data
    ports:
      - "${RECREATIONAL_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${RECREATIONAL_POSTGRES_USER} -d ${RECREATIONAL_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  billing-service-db:
    image: postgres:18
    container_name: hotelier-billing-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${BILLING_POSTGRES_DB}
      POSTGRES_USER: ${BILLING_POSTGRES_USER}
      POSTGRES_PASSWORD: ${BILLING_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - billing_service_db_data:/var/lib/postgresql/data
    ports:
      - "${BILLING_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${BILLING_POSTGRES_USER} -d ${BILLING_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  reports-service-db:
    image: postgres:18
    container_name: hotelier-reports-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${REPORTS_POSTGRES_DB}
      POSTGRES_USER: ${REPORTS_POSTGRES_USER}
      POSTGRES_PASSWORD: ${REPORTS_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - reports_service_db_data:/var/lib/postgresql/data
    ports:
      - "${REPORTS_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${REPORTS_POSTGRES_USER} -d ${REPORTS_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  audit-service-db:
    image: postgres:18
    container_name: hotelier-audit-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${AUDIT_POSTGRES_DB}
      POSTGRES_USER: ${AUDIT_POSTGRES_USER}
      POSTGRES_PASSWORD: ${AUDIT_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - audit_service_db_data:/var/lib/postgresql/data
    ports:
      - "${AUDIT_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${AUDIT_POSTGRES_USER} -d ${AUDIT_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  dashboard-service-db:
    image: postgres:18
    container_name: hotelier-dashboard-service-db-dev
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${DASHBOARD_POSTGRES_DB}
      POSTGRES_USER: ${DASHBOARD_POSTGRES_USER}
      POSTGRES_PASSWORD: ${DASHBOARD_POSTGRES_PASSWORD}
      PGDATA: /var/lib/postgresql/data/pgdata
    volumes:
      - dashboard_service_db_data:/var/lib/postgresql/data
    ports:
      - "${DASHBOARD_POSTGRES_PORT}:5432"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "pg_isready -U ${DASHBOARD_POSTGRES_USER} -d ${DASHBOARD_POSTGRES_DB}",
        ]
      interval: 5s
      timeout: 3s
      retries: 20
      start_period: 10s

  rabbitmq:
    image: rabbitmq:3-management
    container_name: hotelier-rabbitmq-dev
    restart: unless-stopped
    ports:
      - "5672:5672"
      - "15672:15672"
    healthcheck:
      test: ["CMD", "rabbitmq-diagnostics", "-q", "check_port_listener", "5672"]
      interval: 10s
      timeout: 10s
      retries: 10
      start_period: 30s

  pgadmin:
    image: dpage/pgadmin4
    container_name: hotelier-pgadmin-dev
    restart: unless-stopped
    environment:
      PGADMIN_DEFAULT_EMAIL: ${PGADMIN_EMAIL}
      PGADMIN_DEFAULT_PASSWORD: ${PGADMIN_PASSWORD}
      PGADMIN_CONFIG_SERVER_MODE: "False"
    volumes:
      - pgadmin_data:/var/lib/pgadmin
    ports:
      - "5050:80"
    depends_on:
      - backend-db

  backend:
    build:
      context: ../hotelier-backend
    container_name: hotelier-backend-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      PORT: ${API_PORT}
    ports:
      - "${API_PORT}:${API_PORT}"
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      backend-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy
    healthcheck:
      test: ["CMD-SHELL", "curl -fsS http://localhost:${API_PORT}/api || exit 1"]
      interval: 15s
      timeout: 10s
      retries: 10
      start_period: 240s

  auth-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-auth-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      AUTH_DATABASE_URL: postgresql://${AUTH_POSTGRES_USER}:${AUTH_POSTGRES_PASSWORD}@auth-service-db:5432/${AUTH_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start auth-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      auth-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  config-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-config-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      CONFIG_DATABASE_URL: postgresql://${CONFIG_POSTGRES_USER}:${CONFIG_POSTGRES_PASSWORD}@config-service-db:5432/${CONFIG_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start config-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      config-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  parking-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-parking-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      PARKING_DATABASE_URL: postgresql://${PARKING_POSTGRES_USER}:${PARKING_POSTGRES_PASSWORD}@parking-service-db:5432/${PARKING_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start parking-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      parking-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  notifications-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-notifications-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      NOTIFICATIONS_DATABASE_URL: postgresql://${NOTIFICATIONS_POSTGRES_USER}:${NOTIFICATIONS_POSTGRES_PASSWORD}@notifications-service-db:5432/${NOTIFICATIONS_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start notifications-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      notifications-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  staff-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-staff-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      STAFF_DATABASE_URL: postgresql://${STAFF_POSTGRES_USER}:${STAFF_POSTGRES_PASSWORD}@staff-service-db:5432/${STAFF_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start staff-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      staff-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  inventory-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-inventory-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      INVENTORY_DATABASE_URL: postgresql://${INVENTORY_POSTGRES_USER}:${INVENTORY_POSTGRES_PASSWORD}@inventory-service-db:5432/${INVENTORY_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start inventory-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      inventory-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  guest-requests-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-guest-requests-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      GUEST_REQUESTS_DATABASE_URL: postgresql://${GUEST_REQUESTS_POSTGRES_USER}:${GUEST_REQUESTS_POSTGRES_PASSWORD}@guest-requests-service-db:5432/${GUEST_REQUESTS_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start guest-requests-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      guest-requests-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  booking-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-booking-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      BOOKING_DATABASE_URL: postgresql://${BOOKING_POSTGRES_USER}:${BOOKING_POSTGRES_PASSWORD}@booking-service-db:5432/${BOOKING_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start booking-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      booking-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  operations-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-operations-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      OPERATIONS_DATABASE_URL: postgresql://${OPERATIONS_POSTGRES_USER}:${OPERATIONS_POSTGRES_PASSWORD}@operations-service-db:5432/${OPERATIONS_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start operations-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      operations-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  events-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-events-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      EVENTS_DATABASE_URL: postgresql://${EVENTS_POSTGRES_USER}:${EVENTS_POSTGRES_PASSWORD}@events-service-db:5432/${EVENTS_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start events-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      events-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  restaurant-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-restaurant-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      RESTAURANT_DATABASE_URL: postgresql://${RESTAURANT_POSTGRES_USER}:${RESTAURANT_POSTGRES_PASSWORD}@restaurant-service-db:5432/${RESTAURANT_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start restaurant-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      restaurant-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  recreational-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-recreational-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      RECREATIONAL_DATABASE_URL: postgresql://${RECREATIONAL_POSTGRES_USER}:${RECREATIONAL_POSTGRES_PASSWORD}@recreational-service-db:5432/${RECREATIONAL_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start recreational-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      recreational-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy
      notifications-service:
        condition: service_started

  billing-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-billing-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      BILLING_DATABASE_URL: postgresql://${BILLING_POSTGRES_USER}:${BILLING_POSTGRES_PASSWORD}@billing-service-db:5432/${BILLING_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start billing-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      billing-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  reports-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-reports-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      REPORTS_DATABASE_URL: postgresql://${REPORTS_POSTGRES_USER}:${REPORTS_POSTGRES_PASSWORD}@reports-service-db:5432/${REPORTS_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start reports-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      reports-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy
      booking-service:
        condition: service_started
      billing-service:
        condition: service_started

  audit-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-audit-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      AUDIT_DATABASE_URL: postgresql://${AUDIT_POSTGRES_USER}:${AUDIT_POSTGRES_PASSWORD}@audit-service-db:5432/${AUDIT_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start audit-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      audit-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy

  dashboard-service:
    build:
      context: ../hotelier-backend
    container_name: hotelier-dashboard-service-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-backend/.env.docker
    environment:
      DASHBOARD_DATABASE_URL: postgresql://${DASHBOARD_POSTGRES_USER}:${DASHBOARD_POSTGRES_PASSWORD}@dashboard-service-db:5432/${DASHBOARD_POSTGRES_DB}
    command: ["sh", "-c", "npx nest start dashboard-service --watch"]
    volumes:
      - ../hotelier-backend/apps:/app/apps
      - ../hotelier-backend/libs:/app/libs
      - /app/node_modules
    depends_on:
      dashboard-service-db:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy
      booking-service:
        condition: service_started
      billing-service:
        condition: service_started
      operations-service:
        condition: service_started
      guest-requests-service:
        condition: service_started
      staff-service:
        condition: service_started
      auth-service:
        condition: service_started

  frontend:
    build:
      context: ../hotelier-frontend
    container_name: hotelier-frontend-dev
    restart: unless-stopped
    env_file:
      - ../hotelier-frontend/.env.docker
    environment:
      PORT: ${APP_PORT}
    ports:
      - "${APP_PORT}:${APP_PORT}"
    volumes:
      - ../hotelier-frontend/src:/app/src
      - /app/node_modules
    depends_on:
      backend:
        condition: service_healthy

volumes:
  backend_db_data:
  auth_service_db_data:
  config_service_db_data:
  parking_service_db_data:
  notifications_service_db_data:
  inventory_service_db_data:
  staff_service_db_data:
  guest_requests_service_db_data:
  booking_service_db_data:
  operations_service_db_data:
  events_service_db_data:
  restaurant_service_db_data:
  recreational_service_db_data:
  billing_service_db_data:
  reports_service_db_data:
  audit_service_db_data:
  dashboard_service_db_data:
  pgadmin_data:
